<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FIXED Widget Test - Oman Airports</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            min-height: 100vh;
            color: white;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        .alert {
            background: rgba(255,255,255,0.9);
            color: #333;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .test-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        .test-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        .test-btn:hover {
            background: #c82333;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ðŸ”§ FIXED Widget Test</h1>
        <p>Testing the bulletproof formatting solution</p>
    </div>

    <div class="alert">
        <h3>âœ… What's Fixed:</h3>
        <ul>
            <li><strong>Inline CSS styling</strong> for links to ensure they show up</li>
            <li><strong>Ultra-simple formatting</strong> that cannot fail</li>
            <li><strong>Direct innerHTML setting</strong> without complex processing</li>
            <li><strong>Extensive logging</strong> to track what's happening</li>
            <li><strong>Bulletproof link conversion</strong> with guaranteed styling</li>
        </ul>
        <p><strong>The welcome message already shows a working link to verify the fix!</strong></p>
    </div>

    <div class="test-buttons">
        <button class="test-btn" onclick="testParkingQuery()">Test Parking Query</button>
        <button class="test-btn" onclick="testCarRentalQuery()">Test Car Rental Query</button>
        <button class="test-btn" onclick="testDirectMessage()">Test Direct Message</button>
    </div>

    <!-- Chat Widget Configuration -->
    <script>
        window.omanairportsChatConfigFixed = {
            apiUrl: 'http://localhost:3002/api',
            theme: 'light',
            language: 'en',
            position: 'bottom-right',
            autoOpen: true,
            welcomeMessage: 'FIXED widget ready!'
        };

        function testParkingQuery() {
            const input = document.getElementById('chat-widget-input');
            if (input) {
                input.value = 'whats the parking rate at muscat airport for 30 minutes?';
                input.focus();
            }
        }

        function testCarRentalQuery() {
            const input = document.getElementById('chat-widget-input');
            if (input) {
                input.value = 'is dollar car rental service available at muscat airport?';
                input.focus();
            }
        }

        function testDirectMessage() {
            if (window.testWidget) {
                const testMessage = `**Test Message with Formatting:**

This is **bold text** and this is a [clickable link](https://google.com).

ðŸ”— **More Info:** [Muscat Airport](https://www.muscatairport.co.om)`;
                
                window.testWidget.addMessage('bot', testMessage);
            }
        }
    </script>

    <!-- Load the FIXED Chat Widget -->
    <script src="widget/chat-widget-fixed.js"></script>
    <script>
        // Initialize the fixed widget
        setTimeout(() => {
            const widget = new OmanAirportsChatWidget(window.omanairportsChatConfigFixed);
            window.testWidget = widget;
            console.log('ðŸ”§ FIXED widget initialized!');
        }, 1000);
    </script>
</body>
</html> 